####################################################################################################################
####################################################################################################################
# Aggregate output from FASTQuick for all samples by each item.
# Author: Haiying Kong
# Last Modified: 7 June 2021
####################################################################################################################
####################################################################################################################
#!/home/projects/cu_10184/people/haikon/Software/R-4.0.4/bin/Rscript

setwd('/home/projects/cu_10184/projects/PTH')
options(stringsAsFactors=FALSE)
rm(list=ls())

library(stringr)

####################################################################################################################
####################################################################################################################
# Get batch list.
batches = paste0('Primary_', str_pad(1:13, 3, pad='0'))

####################################################################################################################
# Before filtering:
####################################################################################################################
# Collect variants from all samples.
aster = c()
for (batch in batches)  {
  maf.files = dir(paste0('BatchWork/', batch, '/Result/SNV_InDel/AllVariants/Callers_Wide'), pattern='.maf')
  for (maf.file in maf.files)  {
    maf = read.table(paste0('BatchWork/', batch, '/Result/SNV_InDel/AllVariants/Callers_Wide/', maf.file), header=TRUE, quote='', fill=TRUE, sep='\t')
    maf = maf[ ,c(1:6,8,10,13,12,11,24,19)]
    aster = rbind(aster, maf)
    }
  }

####################################################################################################################
####################################################################################################################
