####################################################################################################################
####################################################################################################################
# Identify ITD with ScanITD.
# Author: Haiying Kong
# Last Modified: 1 June 2021
####################################################################################################################
####################################################################################################################
#!/bin/bash -i

####################################################################################################################
####################################################################################################################
# Get batch names.
batches=($(seq -f "%03g" 1 13))
batches=("${batches[@]/#/Primary_}")

# Run cleaning ScanITD for all samples 
for batch in ${batches[@]}
do
  lock_dir=/home/projects/cu_10184/data/projects/PTH/BatchWork/$batch/Lock/ITD/ScanITD

  # Get list of samples.
  cd ${lock_dir}
  vcf_files=($(ls *.itd.vcf))
  samples=($(echo ${vcf_files[@]%.itd.vcf} | tr ' ' '\n' | sort -u | tr '\n' ' '))

  for sample in ${samples[@]}
  do
    Rscript /home/projects/cu_10184/projects/PTH/Code/Source/ITD/Scheme_2/ScanITD_Clean.R ${batch} ${sample} ${lock_dir}
  done
done

####################################################################################################################
####################################################################################################################
